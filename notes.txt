validation is messed up since loss is diff
add checkpointing hook
add attention hook